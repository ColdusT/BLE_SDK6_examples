From 4078e43271025df46fe7b57f31ad02997334b5b7 Mon Sep 17 00:00:00 2001
From: Moh Nikaeen <m.h.nickaeen@gmail.com>
Date: Tue, 21 Mar 2023 15:01:51 +0100
Subject: [PATCH] ibeacon_optimized patch

---
 .../prox_reporter/Eclipse/.cproject           |   2 +-
 .../prox_reporter/Eclipse/.gitignore          |   2 +
 sdk/ble_stack/rwble/rwble.c                   |  12 +
 sdk/platform/arch/arch.h                      |   4 +
 sdk/platform/arch/main/arch_system.c          |   4 +-
 sdk/platform/utilities/otp_cs/otp_cs.c        |   2 +-
 utilities/secondary_bootloader/.cproject      | 316 ++++++++++++++++++
 utilities/secondary_bootloader/.gitignore     |   2 +
 utilities/secondary_bootloader/.project       |  49 +++
 .../secondary_bootloader/ldscript_common.lds  | 152 +++++++++
 utilities/secondary_bootloader/src/main.c     |   6 +
 11 files changed, 547 insertions(+), 4 deletions(-)
 create mode 100644 projects/target_apps/ble_examples/prox_reporter/Eclipse/.gitignore
 create mode 100644 utilities/secondary_bootloader/.cproject
 create mode 100644 utilities/secondary_bootloader/.gitignore
 create mode 100644 utilities/secondary_bootloader/.project
 create mode 100644 utilities/secondary_bootloader/ldscript_common.lds

diff --git a/projects/target_apps/ble_examples/prox_reporter/Eclipse/.cproject b/projects/target_apps/ble_examples/prox_reporter/Eclipse/.cproject
index b13639a..b4cb8aa 100644
--- a/projects/target_apps/ble_examples/prox_reporter/Eclipse/.cproject
+++ b/projects/target_apps/ble_examples/prox_reporter/Eclipse/.cproject
@@ -1156,4 +1156,4 @@
 			<autodiscovery enabled="true" problemReportingEnabled="true" selectedProfileId=""/>
 		</scannerConfigBuildInfo>
 	</storageModule>
-</cproject>
\ No newline at end of file
+</cproject>
diff --git a/projects/target_apps/ble_examples/prox_reporter/Eclipse/.gitignore b/projects/target_apps/ble_examples/prox_reporter/Eclipse/.gitignore
new file mode 100644
index 0000000..dbd57d5
--- /dev/null
+++ b/projects/target_apps/ble_examples/prox_reporter/Eclipse/.gitignore
@@ -0,0 +1,2 @@
+/DA14585/
+/DA14531/
diff --git a/sdk/ble_stack/rwble/rwble.c b/sdk/ble_stack/rwble/rwble.c
index 0793761..a500e7b 100644
--- a/sdk/ble_stack/rwble/rwble.c
+++ b/sdk/ble_stack/rwble/rwble.c
@@ -74,12 +74,20 @@
 #if (WLAN_COEX_ENABLED)
 #include "wlan_coex.h"
 #endif
+#include "lld_util.h"    
+uint8_t change_bd_addr_flag = 0; 
+uint8_t seed_region = 0x00;
+uint8_t store_adv_data_len                     __SECTION_ZERO("retention_mem_area0"); //@RETENTION MEMORY
+uint8_t test_scan_rsp_data_len                __SECTION_ZERO("retention_mem_area0"); //@RETENTION MEMORY
+uint8_t store_adv_data[ADV_DATA_LEN]           __SECTION_ZERO("retention_mem_area0"); //@RETENTION MEMORY
+uint8_t test_scan_rsp_data[SCAN_RSP_DATA_LEN] __SECTION_ZERO("retention_mem_area0"); //@RETENTION MEMORY
 
 last_ble_evt        arch_rwble_last_event           __SECTION_ZERO("retention_mem_area0");
 boost_overhead_st   set_boost_low_vbat1v_overhead   __SECTION_ZERO("retention_mem_area0");
 
 extern uint16_t clk_freq_trim_reg_value;
 
+
 #if defined (__DA14531__)
 extern uint16_t xtal_wait_trim;
 #endif
@@ -941,6 +949,9 @@ const ble_irq_t ble_irq[] =
 
 __BLEIRQ void rwble_isr(void)
 {
+	
+/* Optimize  the time between Tx pulses */
+ble_advtim_set (500);		
 #if defined (__DA14531__)
     if (GetWord32(BLE_CNTL2_REG) & EMACCERRSTAT)
     {
@@ -1091,6 +1102,7 @@ __BLEIRQ void rwble_isr(void)
             DBG_SWDIAG(BLE_ISR, ERRORINT, 0);
         }
     }
+
 #endif // __EXCLUDE_ROM_RWBLE__
 }
 
diff --git a/sdk/platform/arch/arch.h b/sdk/platform/arch/arch.h
index 4abf02a..0735065 100644
--- a/sdk/platform/arch/arch.h
+++ b/sdk/platform/arch/arch.h
@@ -115,6 +115,10 @@ extern uint32_t *rom_cfg_table;
 #define SWD_DATA_AT_P0_5    (0x01)
 #define SWD_DATA_AT_P0_1    (0x02)
 #define SWD_DATA_AT_P0_10   (0x03)
+#define HW_STARTUP_TIME_IN_XTAL32K_CYCLES    (11)   // 11 LP clocks for startup state machine handling
+#define HW_STARTUP_TIME_IN_RCX_CYCLES        (7)    // 7 LP clocks for startup state machine handling
+#define RCX_BLE_PWR_UP_TO_SLP_IRQ_USEC       (60)
+#define XTAL32K_BLE_PWR_UP_TO_SLP_IRQ_USEC   (45)
 #endif
 
 /** @brief OTP memory base address */
diff --git a/sdk/platform/arch/main/arch_system.c b/sdk/platform/arch/main/arch_system.c
index ba168af..4cd214a 100644
--- a/sdk/platform/arch/main/arch_system.c
+++ b/sdk/platform/arch/main/arch_system.c
@@ -662,7 +662,7 @@ void conditionally_run_radio_cals(void)
         last_temp_time = 0;
     }
 
-    if ((current_time - last_temp_time) >= 3200) //2 sec
+    if ((current_time - last_temp_time) >= 500000) 
     {
         last_temp_time = current_time;
 
@@ -958,7 +958,7 @@ uint8_t check_sys_startup_period(void)
 
 __WEAK bool app_use_lower_clocks_check(void)
 {
-    return false;
+    return true;
 }
 
 void lld_sleep_init_func(void)
diff --git a/sdk/platform/utilities/otp_cs/otp_cs.c b/sdk/platform/utilities/otp_cs/otp_cs.c
index 709fdcb..d29b0f7 100644
--- a/sdk/platform/utilities/otp_cs/otp_cs.c
+++ b/sdk/platform/utilities/otp_cs/otp_cs.c
@@ -37,7 +37,7 @@
  * entry.
  ****************************************************************************************
  */
-#define XTAL32M_WAIT_TRIM_TIME_USEC      (1000)  // 1msec
+#define XTAL32M_WAIT_TRIM_TIME_USEC      (500)  // 500usec
 
 /*
  * GLOBAL VARIABLES
diff --git a/utilities/secondary_bootloader/.cproject b/utilities/secondary_bootloader/.cproject
new file mode 100644
index 0000000..af1cba3
--- /dev/null
+++ b/utilities/secondary_bootloader/.cproject
@@ -0,0 +1,316 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no"?>
+<?fileVersion 4.0.0?><cproject storage_type_id="org.eclipse.cdt.core.XmlProjectDescriptionStorage">
+    	
+    <storageModule moduleId="org.eclipse.cdt.core.settings">
+        		
+        <cconfiguration id="ilg.gnuarmeclipse.managedbuild.cross.config.elf.release.690295221">
+            			
+            <storageModule buildSystemId="org.eclipse.cdt.managedbuilder.core.configurationDataProvider" id="ilg.gnuarmeclipse.managedbuild.cross.config.elf.release.690295221" moduleId="org.eclipse.cdt.core.settings" name="Release">
+                				
+                <externalSettings/>
+                				
+                <extensions>
+                    					
+                    <extension id="org.eclipse.cdt.core.ELF" point="org.eclipse.cdt.core.BinaryParser"/>
+                    					
+                    <extension id="org.eclipse.cdt.core.GASErrorParser" point="org.eclipse.cdt.core.ErrorParser"/>
+                    					
+                    <extension id="org.eclipse.cdt.core.GmakeErrorParser" point="org.eclipse.cdt.core.ErrorParser"/>
+                    					
+                    <extension id="org.eclipse.cdt.core.GLDErrorParser" point="org.eclipse.cdt.core.ErrorParser"/>
+                    					
+                    <extension id="org.eclipse.cdt.core.CWDLocator" point="org.eclipse.cdt.core.ErrorParser"/>
+                    					
+                    <extension id="org.eclipse.cdt.core.GCCErrorParser" point="org.eclipse.cdt.core.ErrorParser"/>
+                    				
+                </extensions>
+                			
+            </storageModule>
+            			
+            <storageModule moduleId="cdtBuildSystem" version="4.0.0">
+                				
+                <configuration artifactName="${ProjName}" buildArtefactType="org.eclipse.cdt.build.core.buildArtefactType.exe" buildProperties="org.eclipse.cdt.build.core.buildArtefactType=org.eclipse.cdt.build.core.buildArtefactType.exe,org.eclipse.cdt.build.core.buildType=org.eclipse.cdt.build.core.buildType.release" cleanCommand="${cross_rm} -rf" description="" id="ilg.gnuarmeclipse.managedbuild.cross.config.elf.release.690295221" name="Release" optionalBuildProperties="org.eclipse.cdt.docker.launcher.containerbuild.property.selectedvolumes=,org.eclipse.cdt.docker.launcher.containerbuild.property.volumes=" parent="ilg.gnuarmeclipse.managedbuild.cross.config.elf.release">
+                    					
+                    <folderInfo id="ilg.gnuarmeclipse.managedbuild.cross.config.elf.release.690295221." name="/" resourcePath="">
+                        						
+                        <toolChain id="ilg.gnuarmeclipse.managedbuild.cross.toolchain.elf.release.962101108" name="ARM Cross GCC" superClass="ilg.gnuarmeclipse.managedbuild.cross.toolchain.elf.release">
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.addtools.createflash.640727244" name="Create flash image" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.addtools.createflash" useByScannerDiscovery="false" value="true" valueType="boolean"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.addtools.createlisting.6919812" name="Create extended listing" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.addtools.createlisting" useByScannerDiscovery="false"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.addtools.printsize.1610282971" name="Print size" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.addtools.printsize" useByScannerDiscovery="false" value="true" valueType="boolean"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.optimization.level.41178226" name="Optimization Level" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.optimization.level" useByScannerDiscovery="true" value="ilg.gnuarmeclipse.managedbuild.cross.option.optimization.level.size" valueType="enumerated"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.optimization.messagelength.1899278571" name="Message length (-fmessage-length=0)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.optimization.messagelength" useByScannerDiscovery="true" value="true" valueType="boolean"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.optimization.signedchar.1277246015" name="'char' is signed (-fsigned-char)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.optimization.signedchar" useByScannerDiscovery="true" value="true" valueType="boolean"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.optimization.functionsections.1148032432" name="Function sections (-ffunction-sections)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.optimization.functionsections" useByScannerDiscovery="true" value="true" valueType="boolean"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.optimization.datasections.992468628" name="Data sections (-fdata-sections)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.optimization.datasections" useByScannerDiscovery="true" value="true" valueType="boolean"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.debugging.level.1408640963" name="Debug level" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.debugging.level" useByScannerDiscovery="true" value="ilg.gnuarmeclipse.managedbuild.cross.option.debugging.level.none" valueType="enumerated"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.debugging.format.1155309537" name="Debug format" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.debugging.format" useByScannerDiscovery="true"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.toolchain.name.1712748901" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.toolchain.name" useByScannerDiscovery="false" value="GNU Tools for ARM Embedded Processors" valueType="string"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.architecture.1669108283" name="Architecture" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.architecture" useByScannerDiscovery="false" value="ilg.gnuarmeclipse.managedbuild.cross.option.architecture.arm" valueType="enumerated"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.arm.target.family.336893400" name="ARM family (-mcpu)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.arm.target.family" useByScannerDiscovery="false" value="ilg.gnuarmeclipse.managedbuild.cross.option.arm.target.mcpu.cortex-m0plus" valueType="enumerated"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.arm.target.instructionset.592925440" name="Instruction set" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.arm.target.instructionset" useByScannerDiscovery="false" value="ilg.gnuarmeclipse.managedbuild.cross.option.arm.target.instructionset.thumb" valueType="enumerated"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.command.prefix.1023872524" name="Prefix" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.command.prefix" useByScannerDiscovery="false" value="arm-none-eabi-" valueType="string"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.command.c.1628829769" name="C compiler" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.command.c" useByScannerDiscovery="false" value="gcc" valueType="string"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.command.cpp.1901161751" name="C++ compiler" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.command.cpp" useByScannerDiscovery="false" value="g++" valueType="string"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.command.ar.1332742671" name="Archiver" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.command.ar" useByScannerDiscovery="false" value="ar" valueType="string"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.command.objcopy.1156938311" name="Hex/Bin converter" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.command.objcopy" useByScannerDiscovery="false" value="objcopy" valueType="string"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.command.objdump.102367559" name="Listing generator" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.command.objdump" useByScannerDiscovery="false" value="objdump" valueType="string"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.command.size.1345569529" name="Size command" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.command.size" useByScannerDiscovery="false" value="size" valueType="string"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.command.make.1033750592" name="Build command" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.command.make" useByScannerDiscovery="false" value="make" valueType="string"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.command.rm.70706058" name="Remove command" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.command.rm" useByScannerDiscovery="false" value="rm" valueType="string"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.toolchain.id.764953307" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.toolchain.id" useByScannerDiscovery="false" value="1287942917" valueType="string"/>
+                            							
+                            <option id="ilg.gnuarmeclipse.managedbuild.cross.option.warnings.allwarn.1398512222" name="Enable all common warnings (-Wall)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.warnings.allwarn" value="true" valueType="boolean"/>
+                            							
+                            <targetPlatform archList="all" binaryParser="org.eclipse.cdt.core.ELF" id="ilg.gnuarmeclipse.managedbuild.cross.targetPlatform.428512820" isAbstract="false" osList="all" superClass="ilg.gnuarmeclipse.managedbuild.cross.targetPlatform"/>
+                            							
+                            <builder buildPath="${workspace_loc:/secondary_bootloader}/Release" id="ilg.gnuarmeclipse.managedbuild.cross.builder.222680980" incrementalBuildTarget="all V=1" keepEnvironmentInBuildfile="false" managedBuildOn="true" name="Gnu Make Builder" parallelBuildOn="true" parallelizationNumber="optimal" superClass="ilg.gnuarmeclipse.managedbuild.cross.builder"/>
+                            							
+                            <tool id="ilg.gnuarmeclipse.managedbuild.cross.tool.assembler.906408729" name="GNU ARM Cross Assembler" superClass="ilg.gnuarmeclipse.managedbuild.cross.tool.assembler">
+                                								
+                                <option id="ilg.gnuarmeclipse.managedbuild.cross.option.assembler.usepreprocessor.1889401618" name="Use preprocessor" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.assembler.usepreprocessor" useByScannerDiscovery="false" value="true" valueType="boolean"/>
+                                								
+                                <option IS_BUILTIN_EMPTY="false" IS_VALUE_EMPTY="false" id="ilg.gnuarmeclipse.managedbuild.cross.option.assembler.defs.1797942208" name="Defined symbols (-D)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.assembler.defs" useByScannerDiscovery="true" valueType="definedSymbols">
+                                    									
+                                    <listOptionValue builtIn="false" value="__DA14531__"/>
+                                    								
+                                </option>
+                                								
+                                <inputType id="ilg.gnuarmeclipse.managedbuild.cross.tool.assembler.input.547603028" superClass="ilg.gnuarmeclipse.managedbuild.cross.tool.assembler.input"/>
+                                							
+                            </tool>
+                            							
+                            <tool id="ilg.gnuarmeclipse.managedbuild.cross.tool.c.compiler.1576227966" name="GNU ARM Cross C Compiler" superClass="ilg.gnuarmeclipse.managedbuild.cross.tool.c.compiler">
+                                								
+                                <option IS_BUILTIN_EMPTY="false" IS_VALUE_EMPTY="false" id="ilg.gnuarmeclipse.managedbuild.cross.option.c.compiler.include.paths.425005436" name="Include paths (-I)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.c.compiler.include.paths" useByScannerDiscovery="true" valueType="includePath">
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/arch}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/arch/compiler}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/arch/ll}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/arch/main}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/include}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/include/CMSIS/5.6.0/Include}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/core_modules/crypto}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/core_modules/common/api}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/core_modules/nvds/api}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/core_modules/rf/api}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/core_modules/rwip/api}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/driver/dma}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/driver/spi_flash}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/driver/gpio}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/driver/i2c}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/driver/i2c_eeprom}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/driver/syscntl}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/driver/spi}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/driver/adc}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/driver/uart}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/driver/hw_otpc}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/driver/systick}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/utilities/otp_hdr}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/platform/utilities/otp_cs}&quot;"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/includes}&quot;"/>
+                                    								
+                                </option>
+                                								
+                                <option IS_BUILTIN_EMPTY="false" IS_VALUE_EMPTY="false" id="ilg.gnuarmeclipse.managedbuild.cross.option.c.compiler.defs.27201832" name="Defined symbols (-D)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.c.compiler.defs" useByScannerDiscovery="true" valueType="definedSymbols">
+                                    									
+                                    <listOptionValue builtIn="false" value="__DA14531__"/>
+                                    									
+                                    <listOptionValue builtIn="false" value="__NON_BLE_EXAMPLE__"/>
+                                    								
+                                </option>
+                                								
+                                <option IS_BUILTIN_EMPTY="false" IS_VALUE_EMPTY="false" id="ilg.gnuarmeclipse.managedbuild.cross.option.c.compiler.include.systempaths.235821266" name="Include system paths (-isystem)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.c.compiler.include.systempaths" useByScannerDiscovery="true" valueType="includePath">
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/sdk/driver/i2c_eeprom}&quot;"/>
+                                    								
+                                </option>
+                                								
+                                <inputType id="ilg.gnuarmeclipse.managedbuild.cross.tool.c.compiler.input.1304080279" superClass="ilg.gnuarmeclipse.managedbuild.cross.tool.c.compiler.input"/>
+                                							
+                            </tool>
+                            							
+                            <tool id="ilg.gnuarmeclipse.managedbuild.cross.tool.cpp.compiler.154300612" name="GNU ARM Cross C++ Compiler" superClass="ilg.gnuarmeclipse.managedbuild.cross.tool.cpp.compiler"/>
+                            							
+                            <tool id="ilg.gnuarmeclipse.managedbuild.cross.tool.c.linker.127699913" name="GNU ARM Cross C Linker" superClass="ilg.gnuarmeclipse.managedbuild.cross.tool.c.linker">
+                                								
+                                <option id="ilg.gnuarmeclipse.managedbuild.cross.option.c.linker.gcsections.617905034" name="Remove unused sections (-Xlinker --gc-sections)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.c.linker.gcsections" useByScannerDiscovery="false" value="true" valueType="boolean"/>
+                                								
+                                <option IS_BUILTIN_EMPTY="false" IS_VALUE_EMPTY="false" id="ilg.gnuarmeclipse.managedbuild.cross.option.c.linker.scriptfile.1425516032" name="Script files (-T)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.c.linker.scriptfile" useByScannerDiscovery="false" valueType="stringList">
+                                    									
+                                    <listOptionValue builtIn="false" value="&quot;${workspace_loc:/${ProjName}/ldscript_common.lds}&quot;"/>
+                                    								
+                                </option>
+                                								
+                                <option id="ilg.gnuarmeclipse.managedbuild.cross.option.c.linker.usenewlibnano.200582180" name="Use newlib-nano (--specs=nano.specs)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.c.linker.usenewlibnano" useByScannerDiscovery="false" value="true" valueType="boolean"/>
+                                								
+                                <option id="ilg.gnuarmeclipse.managedbuild.cross.option.c.linker.usenewlibnosys.1691182181" name="Do not use syscalls (--specs=nosys.specs)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.c.linker.usenewlibnosys" useByScannerDiscovery="false" value="true" valueType="boolean"/>
+                                								
+                                <option id="ilg.gnuarmeclipse.managedbuild.cross.option.c.linker.verbose.490928713" name="Verbose (-v)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.c.linker.verbose" useByScannerDiscovery="false" value="true" valueType="boolean"/>
+                                								
+                                <inputType id="ilg.gnuarmeclipse.managedbuild.cross.tool.c.linker.input.1006598327" superClass="ilg.gnuarmeclipse.managedbuild.cross.tool.c.linker.input">
+                                    									
+                                    <additionalInput kind="additionalinputdependency" paths="$(USER_OBJS)"/>
+                                    									
+                                    <additionalInput kind="additionalinput" paths="$(LIBS)"/>
+                                    								
+                                </inputType>
+                                							
+                            </tool>
+                            							
+                            <tool id="ilg.gnuarmeclipse.managedbuild.cross.tool.cpp.linker.1089284439" name="GNU ARM Cross C++ Linker" superClass="ilg.gnuarmeclipse.managedbuild.cross.tool.cpp.linker">
+                                								
+                                <option id="ilg.gnuarmeclipse.managedbuild.cross.option.cpp.linker.gcsections.1258013338" name="Remove unused sections (-Xlinker --gc-sections)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.cpp.linker.gcsections" value="true" valueType="boolean"/>
+                                							
+                            </tool>
+                            							
+                            <tool id="ilg.gnuarmeclipse.managedbuild.cross.tool.archiver.1527233353" name="GNU ARM Cross Archiver" superClass="ilg.gnuarmeclipse.managedbuild.cross.tool.archiver"/>
+                            							
+                            <tool id="ilg.gnuarmeclipse.managedbuild.cross.tool.createflash.466446568" name="GNU ARM Cross Create Flash Image" superClass="ilg.gnuarmeclipse.managedbuild.cross.tool.createflash">
+                                								
+                                <option id="ilg.gnuarmeclipse.managedbuild.cross.option.createflash.choice.331700753" name="Output file format (-O)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.createflash.choice" useByScannerDiscovery="false" value="ilg.gnuarmeclipse.managedbuild.cross.option.createflash.choice.binary" valueType="enumerated"/>
+                                							
+                            </tool>
+                            							
+                            <tool id="ilg.gnuarmeclipse.managedbuild.cross.tool.createlisting.1924154656" name="GNU ARM Cross Create Listing" superClass="ilg.gnuarmeclipse.managedbuild.cross.tool.createlisting">
+                                								
+                                <option id="ilg.gnuarmeclipse.managedbuild.cross.option.createlisting.source.1315751513" name="Display source (--source|-S)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.createlisting.source" value="true" valueType="boolean"/>
+                                								
+                                <option id="ilg.gnuarmeclipse.managedbuild.cross.option.createlisting.allheaders.1090466235" name="Display all headers (--all-headers|-x)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.createlisting.allheaders" value="true" valueType="boolean"/>
+                                								
+                                <option id="ilg.gnuarmeclipse.managedbuild.cross.option.createlisting.demangle.640217732" name="Demangle names (--demangle|-C)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.createlisting.demangle" value="true" valueType="boolean"/>
+                                								
+                                <option id="ilg.gnuarmeclipse.managedbuild.cross.option.createlisting.linenumbers.1296181355" name="Display line numbers (--line-numbers|-l)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.createlisting.linenumbers" value="true" valueType="boolean"/>
+                                								
+                                <option id="ilg.gnuarmeclipse.managedbuild.cross.option.createlisting.wide.332334354" name="Wide lines (--wide|-w)" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.createlisting.wide" value="true" valueType="boolean"/>
+                                							
+                            </tool>
+                            							
+                            <tool id="ilg.gnuarmeclipse.managedbuild.cross.tool.printsize.1846015187" name="GNU ARM Cross Print Size" superClass="ilg.gnuarmeclipse.managedbuild.cross.tool.printsize">
+                                								
+                                <option id="ilg.gnuarmeclipse.managedbuild.cross.option.printsize.format.769830721" name="Size format" superClass="ilg.gnuarmeclipse.managedbuild.cross.option.printsize.format" useByScannerDiscovery="false"/>
+                                							
+                            </tool>
+                            						
+                        </toolChain>
+                        					
+                    </folderInfo>
+                    					
+                    <sourceEntries>
+                        						
+                        <entry excluding="sdk/platform/arch/main/arch_hibernation.c|sdk/platform/utilities/otp_hdr/otp_hdr.c|sdk/platform/core_modules/crypto/aes_task.c|sdk/platform/core_modules/crypto/aes_cmac.c|sdk/platform/core_modules/crypto/aes_ccm.c|sdk/platform/core_modules/crypto/aes_cbc.c|sdk/platform/core_modules/crypto/aes_api.c|sdk/platform/core_modules/crypto/aes.c|sdk/platform/arch/boot/GCC/startup_DA14585_586.S|sdk/platform/arch/boot/GCC/ivtable_DA14585_586.S|sdk/platform/arch/boot/system_DA14585_586.c|sdk/platform/arch/boot/ARM|sdk/platform/arch/main/jump_table.c|sdk/platform/arch/main/arch_sleep.c|sdk/platform/arch/main/arch_rom.c|sdk/platform/arch/main/arch_main.c|sdk/platform/core_modules/nvds|sdk/platform/core_modules/rf|sdk/platform/core_modules/rwip|sdk/platform/driver/hw_otpc/hw_otpc_58x.c|sdk/platform/driver/spi/spi_58x.c|sdk/platform/driver/pdm|sdk/platform/driver/ble|sdk/platform/driver/battery|sdk/platform/driver/adc|sdk/platform/driver/timer|sdk/platform/driver/trng/trng.c|sdk/platform/driver/uart/uart.c|sdk/platform/driver/uart/uart_utils.c|sdk/platform/driver/wkupct_quadec/wkupct_quadec.c" flags="VALUE_WORKSPACE_PATH|RESOLVED" kind="sourcePath" name=""/>
+                        					
+                    </sourceEntries>
+                    				
+                </configuration>
+                			
+            </storageModule>
+            			
+            <storageModule moduleId="org.eclipse.cdt.core.externalSettings"/>
+            			
+            <storageModule moduleId="ilg.gnumcueclipse.managedbuild.packs"/>
+            		
+        </cconfiguration>
+        	
+    </storageModule>
+    	
+    <storageModule moduleId="cdtBuildSystem" version="4.0.0">
+        		
+        <project id="secondary_bootloader.ilg.gnuarmeclipse.managedbuild.cross.target.elf.1602362985" name="Executable" projectType="ilg.gnuarmeclipse.managedbuild.cross.target.elf"/>
+        	
+    </storageModule>
+    	
+    <storageModule moduleId="scannerConfiguration">
+        		
+        <autodiscovery enabled="true" problemReportingEnabled="true" selectedProfileId=""/>
+        		
+        <scannerConfigBuildInfo instanceId="ilg.gnuarmeclipse.managedbuild.cross.config.elf.debug.1862726372;ilg.gnuarmeclipse.managedbuild.cross.config.elf.debug.1862726372.;ilg.gnuarmeclipse.managedbuild.cross.tool.c.compiler.1864434676;ilg.gnuarmeclipse.managedbuild.cross.tool.c.compiler.input.1423702104">
+            			
+            <autodiscovery enabled="true" problemReportingEnabled="true" selectedProfileId=""/>
+            		
+        </scannerConfigBuildInfo>
+        		
+        <scannerConfigBuildInfo instanceId="ilg.gnuarmeclipse.managedbuild.cross.config.elf.release.690295221;ilg.gnuarmeclipse.managedbuild.cross.config.elf.release.690295221.;ilg.gnuarmeclipse.managedbuild.cross.tool.c.compiler.1576227966;ilg.gnuarmeclipse.managedbuild.cross.tool.c.compiler.input.1304080279">
+            			
+            <autodiscovery enabled="true" problemReportingEnabled="true" selectedProfileId=""/>
+            		
+        </scannerConfigBuildInfo>
+        	
+    </storageModule>
+    	
+    <storageModule moduleId="org.eclipse.cdt.core.LanguageSettingsProviders"/>
+    	
+    <storageModule moduleId="refreshScope" versionNumber="2">
+        		
+        <configuration configurationName="Multiple configurations">
+            			
+            <resource resourceType="PROJECT" workspacePath="/secondary_bootloader"/>
+            		
+        </configuration>
+        		
+        <configuration configurationName="Release">
+            			
+            <resource resourceType="PROJECT" workspacePath="/secondary_bootloader"/>
+            		
+        </configuration>
+        		
+        <configuration configurationName="Debug">
+            			
+            <resource resourceType="PROJECT" workspacePath="/secondary_bootloader"/>
+            		
+        </configuration>
+        	
+    </storageModule>
+    	
+    <storageModule moduleId="org.eclipse.cdt.make.core.buildtargets"/>
+    	
+    <storageModule moduleId="org.eclipse.cdt.internal.ui.text.commentOwnerProjectMappings"/>
+    
+</cproject>
diff --git a/utilities/secondary_bootloader/.gitignore b/utilities/secondary_bootloader/.gitignore
new file mode 100644
index 0000000..6f5d8ad
--- /dev/null
+++ b/utilities/secondary_bootloader/.gitignore
@@ -0,0 +1,2 @@
+Debug/
+Release/
\ No newline at end of file
diff --git a/utilities/secondary_bootloader/.project b/utilities/secondary_bootloader/.project
new file mode 100644
index 0000000..217dfbe
--- /dev/null
+++ b/utilities/secondary_bootloader/.project
@@ -0,0 +1,49 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<projectDescription>
+	<name>secondary_bootloader</name>
+	<comment></comment>
+	<projects>
+	</projects>
+	<buildSpec>
+		<buildCommand>
+			<name>org.eclipse.cdt.managedbuilder.core.genmakebuilder</name>
+			<triggers>clean,full,incremental,</triggers>
+			<arguments>
+			</arguments>
+		</buildCommand>
+		<buildCommand>
+			<name>org.eclipse.cdt.managedbuilder.core.ScannerConfigBuilder</name>
+			<triggers>full,incremental,</triggers>
+			<arguments>
+			</arguments>
+		</buildCommand>
+	</buildSpec>
+	<natures>
+		<nature>org.eclipse.cdt.core.cnature</nature>
+		<nature>org.eclipse.cdt.managedbuilder.core.managedBuildNature</nature>
+		<nature>org.eclipse.cdt.managedbuilder.core.ScannerConfigNature</nature>
+	</natures>
+	<linkedResources>
+		<link>
+			<name>sdk</name>
+			<type>2</type>
+			<locationURI>virtual:/virtual</locationURI>
+		</link>
+		<link>
+			<name>sdk/crc32</name>
+			<type>2</type>
+			<locationURI>SDKROOT/third_party/crc32</locationURI>
+		</link>
+		<link>
+			<name>sdk/platform</name>
+			<type>2</type>
+			<locationURI>SDKROOT/sdk/platform</locationURI>
+		</link>
+	</linkedResources>
+	<variableList>
+		<variable>
+			<name>SDKROOT</name>
+			<value>$%7BWORKSPACE_LOC%7D</value>
+		</variable>
+	</variableList>
+</projectDescription>
diff --git a/utilities/secondary_bootloader/ldscript_common.lds b/utilities/secondary_bootloader/ldscript_common.lds
new file mode 100644
index 0000000..fff9371
--- /dev/null
+++ b/utilities/secondary_bootloader/ldscript_common.lds
@@ -0,0 +1,152 @@
+MEMORY
+{
+    LR_IROM1 (rwx) : ORIGIN = 0x07fc0000, LENGTH = 0xC0
+    LR_IROM2 (rwx) : ORIGIN = 0x07fc0000 + 0xC0, LENGTH = 0x50
+    LR_IROM3 (rwx) : ORIGIN = (0x07fc0000 + 0xC0 + 0x50), LENGTH = ((((((((0x07FC9C00) + (((((0x0000033E) + (( (3 * 3) + (3 + 3)) * (262))) + ((8) * (262))) + (6)) - ((((0x0000033E) + (((5) + (((1))) + (3)) * ((((251)) | 0x01) + 4 + 7))) + ((8) * ((((251)) | 0x01) + 4 + 7))) + (6)))) & (0xFFFFC00)) - ((0) + (2200) + ( ((((((((244 + 4) + (248 + 4) + (148 + 4) + (28 + 4)) * ((1)))) + 3) / 4) * 4) + 12) + (((((1024) + 3) / 4) * 4) + 12) + (((((( 256 * (((1)) + 1) + 80 * ((1)) + 96 * (2 * ((1)) + 1) + 256 + 256 * ((1)) )) + 3) / 4) * 4) + 12) ))))+3) & (~(3))) - (0x07fc0000 + 0xC0 + 0x50))
+    LR_RETAINED_RAM0 (rw) : ORIGIN = (((((((0x07FC9C00) + (((((0x0000033E) + (( (3 * 3) + (3 + 3)) * (262))) + ((8) * (262))) + (6)) - ((((0x0000033E) + (((5) + (((1))) + (3)) * ((((251)) | 0x01) + 4 + 7))) + ((8) * ((((251)) | 0x01) + 4 + 7))) + (6)))) & (0xFFFFC00)) - ((0) + (2200) + ( ((((((((244 + 4) + (248 + 4) + (148 + 4) + (28 + 4)) * ((1)))) + 3) / 4) * 4) + 12) + (((((1024) + 3) / 4) * 4) + 12) + (((((( 256 * (((1)) + 1) + 80 * ((1)) + 96 * (2 * ((1)) + 1) + 256 + 256 * ((1)) )) + 3) / 4) * 4) + 12) ))))+3) & (~(3))), LENGTH = (((((0) + (2200) + ( ((((((((244 + 4) + (248 + 4) + (148 + 4) + (28 + 4)) * ((1)))) + 3) / 4) * 4) + 12) + (((((1024) + 3) / 4) * 4) + 12) + (((((( 256 * (((1)) + 1) + 80 * ((1)) + 96 * (2 * ((1)) + 1) + 256 + 256 * ((1)) )) + 3) / 4) * 4) + 12) )))+3) & (~(3)))
+}
+__ER_IROM3_BASE__ = ORIGIN(LR_IROM3);
+__ER_IROM3_LENGTH__ = LENGTH(LR_IROM3);
+ENTRY(Reset_Handler)
+SECTIONS
+{
+    ER_IROM1 :
+    {
+        KEEP(*(.vectors))
+        . = 0xC0;
+    } > LR_IROM1
+    ER_IROM2 :
+    {
+        KEEP(*(.patch_table))
+        . = 0x50;
+    } > LR_IROM2
+    ER_IROM3 :
+    {
+        KEEP(*(.isr_impl))
+        KEEP(*(.text.disp_heaplog))
+        *(.text*)
+        . = ALIGN(4);
+        KEEP(*(.init))
+        KEEP(*(.fini))
+        *(.rodata*)
+    } > LR_IROM3
+    .ARM.extab :
+    {
+        *(.ARM.extab* .gnu.linkonce.armextab.*)
+    } > LR_IROM3
+    __exidx_start = .;
+    .ARM.exidx :
+    {
+       *(.ARM.exidx* .gnu.linkonce.armexidx.*)
+    } > LR_IROM3
+    __exidx_end = .;
+    .copy.table :
+    {
+        . = ALIGN(4);
+        __copy_table_start__ = .;
+        LONG (__etext)
+        LONG (__data_start__)
+        LONG (__data_end__ - __data_start__)
+        __copy_table_end__ = .;
+    } > LR_IROM3
+    .zero.table :
+    {
+        . = ALIGN(4);
+        __zero_table_start__ = .;
+        LONG (__bss_start__)
+        LONG (__bss_end__ - __bss_start__)
+        LONG (__heap_mem_area_not_ret_start__)
+        LONG (__heap_mem_area_not_ret_end__ - __heap_mem_area_not_ret_start__)
+        LONG (__ret_data_start__)
+        LONG (__ret_data_end__ - __ret_data_start__)
+        __zero_table_end__ = .;
+    } > LR_IROM3
+    __etext = ALIGN(4);
+    .data : AT (__etext)
+    {
+        __data_start__ = .;
+        *(vtable)
+        *(.data*)
+        . = ALIGN(4);
+        PROVIDE_HIDDEN (__preinit_array_start = .);
+        KEEP(*(.preinit_array))
+        PROVIDE_HIDDEN (__preinit_array_end = .);
+        . = ALIGN(4);
+        PROVIDE_HIDDEN (__init_array_start = .);
+        KEEP(*(SORT(.init_array.*)))
+        KEEP(*(.init_array))
+        PROVIDE_HIDDEN (__init_array_end = .);
+        . = ALIGN(4);
+        PROVIDE_HIDDEN (__fini_array_start = .);
+        KEEP(*(SORT(.fini_array.*)))
+        KEEP(*(.fini_array))
+        PROVIDE_HIDDEN (__fini_array_end = .);
+        KEEP(*(.jcr*))
+        . = ALIGN(4);
+        __data_end__ = .;
+    } > LR_IROM3
+    __code_area_end__ = .;
+    .bss :
+    {
+        . = ALIGN(4);
+        __bss_start__ = .;
+        *(.bss*)
+        *(COMMON)
+        . = ALIGN(4);
+        __bss_end__ = .;
+    } > LR_IROM3
+    ER_PRODTEST (NOLOAD):
+    {
+        . = ALIGN(4);
+        *(prodtest_uninit)
+    } > LR_IROM3
+    ER_ZI (NOLOAD) :
+    {
+        . = ALIGN(4);
+        __heap_mem_area_not_ret_start__ = .;
+        *jump_table.o(heap_mem_area_not_ret)
+        . = ALIGN(4);
+        __heap_mem_area_not_ret_end__ = .;
+    } > LR_IROM3
+    .heap (NOLOAD):
+    {
+        __end__ = .;
+        PROVIDE(end = .);
+        *(.heap*)
+        __HeapLimit = .;
+    } > LR_IROM3
+    .stack_dummy (COPY):
+    {
+       KEEP(*(.stack*))
+    } > LR_IROM3
+    __StackTop = ORIGIN(LR_IROM3) + LENGTH(LR_IROM3);
+    __StackLimit = __StackTop - SIZEOF(.stack_dummy);
+    PROVIDE(__stack = __StackTop);
+    ASSERT(__StackLimit >= __HeapLimit, "region RAM overflowed with stack")
+    RET_DATA_UNINIT (((((((0x07FC9C00) + (((((0x0000033E) + (( (3 * 3) + (3 + 3)) * (262))) + ((8) * (262))) + (6)) - ((((0x0000033E) + (((5) + (((1))) + (3)) * ((((251)) | 0x01) + 4 + 7))) + ((8) * ((((251)) | 0x01) + 4 + 7))) + (6)))) & (0xFFFFC00)) - ((0) + (2200) + ( ((((((((244 + 4) + (248 + 4) + (148 + 4) + (28 + 4)) * ((1)))) + 3) / 4) * 4) + 12) + (((((1024) + 3) / 4) * 4) + 12) + (((((( 256 * (((1)) + 1) + 80 * ((1)) + 96 * (2 * ((1)) + 1) + 256 + 256 * ((1)) )) + 3) / 4) * 4) + 12) ))))+3) & (~(3))) (NOLOAD) :
+    {
+        . = ALIGN(4);
+        __ret_data_start__ = .;
+        __retention_mem_area_uninit_start__ = .;
+        *(retention_mem_area_uninit)
+        . = ALIGN(4);
+        __retention_mem_area_uninit_end__ = .;
+    } > LR_RETAINED_RAM0
+    ASSERT(SIZEOF(RET_DATA_UNINIT) <= (0), "RET_DATA_UNINIT to small!")
+    RET_DATA (NOLOAD) :
+    {
+        . = ALIGN(4);
+        *(retention_mem_area0)
+        . = ALIGN(4);
+        __ret_data_end__ = .;
+    } > LR_RETAINED_RAM0
+    ASSERT(SIZEOF(RET_DATA) <= (2200), "RET_DATA to small!")
+    RET_HEAP (NOLOAD):
+    {
+        . = ALIGN(4);
+        *jump_table.o(heap_env_area)
+        *jump_table.o(heap_db_area)
+        *jump_table.o(heap_msg_area)
+    } > LR_RETAINED_RAM0
+    ASSERT(SIZEOF(RET_HEAP) <= ( ((((((((244 + 4) + (248 + 4) + (148 + 4) + (28 + 4)) * ((1)))) + 3) / 4) * 4) + 12) + (((((1024) + 3) / 4) * 4) + 12) + (((((( 256 * (((1)) + 1) + 80 * ((1)) + 96 * (2 * ((1)) + 1) + 256 + 256 * ((1)) )) + 3) / 4) * 4) + 12) ), "RET_HEAP to small!")
+}
diff --git a/utilities/secondary_bootloader/src/main.c b/utilities/secondary_bootloader/src/main.c
index 1dec84c..f024467 100644
--- a/utilities/secondary_bootloader/src/main.c
+++ b/utilities/secondary_bootloader/src/main.c
@@ -450,3 +450,9 @@ int main(void)
     } // while (1)
 }
 
+#if defined (__GNUC__)
+// Defining these functions forces the linker to ignore unwind functions
+void __aeabi_unwind_cpp_pr0(void) {};
+void __aeabi_unwind_cpp_pr1(void) {};
+void __aeabi_unwind_cpp_pr2(void) {};
+#endif
-- 
2.39.2.windows.1

